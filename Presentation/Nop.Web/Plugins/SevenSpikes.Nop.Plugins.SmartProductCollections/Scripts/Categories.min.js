/*
* Copyright 2016 Seven Spikes Ltd. All rights reserved. (http://www.nop-templates.com)
* http://www.nop-templates.com/t/licensinginfo
*/

!function(t){var e=t(window),a=function(){0===t(".spc-categories[notLoaded]").length&&e.off("scroll.smart-products-categories")},o=function(){var o=e.scrollTop()+e.outerHeight();t(".spc-categories[notLoaded]").each(function(){var e=t(this);e.offset().top<o&&(e.removeAttr("notLoaded"),t.ajax({url:e.attr("data-getCategoryGroupInfoUrl"),type:"POST",data:{categoryId:parseInt(e.attr("data-categoryGroupId"))||0}}).done(function(a){e.html(a),e.find(".spc-header .tab:first-of-type").removeAttr("notLoaded").addClass("active"),e.find(".category-products .product-grid:first-of-type").addClass("active"),t.event.trigger({type:"newProductsAddedToPageEvent"})}).fail(function(){e.remove()}))}),a()},r=function(){t(".spc-categories").on("click",".spc-header .tab",function(){var e=t(this),a=parseInt(e.attr("data-sourceTypeId"))||0,o=e.closest(".spc-categories"),r=parseInt(o.attr("data-categoryGroupId"))||0,d=o.find('.category-products .product-grid[data-sourceTypeId="'+a+'"]');e.is("[notLoaded]")?(e.removeAttr("notLoaded"),o.find(".loading-overlay").show(),t.ajax({url:o.attr("data-getProductsForSourceUrl"),type:"POST",data:{categoryId:r,sourceTypeId:a}}).done(function(a){d.children(".item-grid").html(a),e.addClass("active").siblings(".tab").removeClass("active"),d.addClass("active").siblings(".product-grid").removeClass("active"),t.event.trigger({type:"newProductsAddedToPageEvent"})}).always(function(){o.find(".loading-overlay").fadeOut()})):(e.addClass("active").siblings(".tab").removeClass("active"),d.addClass("active").siblings(".product-grid").removeClass("active"))})};t(document).ready(function(){r(),setTimeout(o,200),e.on("scroll.smart-products-categories",o)})}(jQuery);
